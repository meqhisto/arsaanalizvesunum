<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Arsa Yatırım Danışmanlığı</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/chart.js@3.7.0/dist/chart.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
        .navbar {
            padding: 1rem;
            box-shadow: 0 2px 4px rgba(0,0,0,.1);
        }
        .navbar-brand {
            font-size: 1.5rem;
            font-weight: bold;
        }
        .user-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        .dashboard-card {
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.2s;
        }
        .dashboard-card:hover {
            transform: translateY(-5px);
        }
        .stat-card {
            background: linear-gradient(135deg, #007bff, #6610f2);
            color: white;
        }
    </style>
</head>
<body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="bi bi-building"></i> Arsa Yatırım
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="{{ url_for('index') }}">
                            <i class="bi bi-house-door"></i> Ana Sayfa
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">
                            <i class="bi bi-graph-up"></i> Analizlerim
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">
                            <i class="bi bi-folder"></i> Portföyüm
                        </a>
                    </li>
                </ul>
                <div class="user-info">
                    <span class="navbar-text text-white">
                        <i class="bi bi-person-circle"></i> {{ session['email'] }}
                    </span>
                    <a href="{{ url_for('logout') }}" class="btn btn-light">
                        <i class="bi bi-box-arrow-right"></i> Çıkış Yap
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Dashboard Content -->
    <div class="container mt-4">
        <!-- Üst İstatistik Kartları -->
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="card dashboard-card stat-card">
                    <div class="card-body">
                        <h5 class="card-title">Toplam Analiz</h5>
                        <h2 class="mb-0">{{ stats.toplam_analiz }}</h2>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card dashboard-card stat-card">
                    <div class="card-body">
                        <h5 class="card-title">Aktif Projeler</h5>
                        <h2 class="mb-0">{{ stats.aktif_projeler }}</h2>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card dashboard-card stat-card">
                    <div class="card-body">
                        <h5 class="card-title">Toplam Değer</h5>
                        <h2 class="mb-0">₺{{ stats.toplam_deger }}</h2>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card dashboard-card stat-card">
                    <div class="card-body">
                        <h5 class="card-title">Ortalama ROI</h5>
                        <h2 class="mb-0">%{{ stats.ortalama_roi }}</h2>
                    </div>
                </div>
            </div>
        </div>

        <!-- Grafikler -->
        <div class="row mb-4">
            <div class="col-md-6">
                <div class="card dashboard-card">
                    <div class="card-body">
                        <h5 class="card-title">Bölgelere Göre Dağılım</h5>
                        <canvas id="locationChart"></canvas>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card dashboard-card">
                    <div class="card-body">
                        <h5 class="card-title">Yatırım Performansı</h5>
                        <canvas id="performanceChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Yeni Analiz Butonu -->
        <div class="text-center mb-4">
            <button type="button" class="btn btn-primary btn-lg" data-bs-toggle="modal" data-bs-target="#analysisModal">
                <i class="bi bi-plus-circle"></i> Yeni Analiz
            </button>
        </div>

        <!-- Analiz Formu Modal -->
        <div class="modal fade" id="analysisModal" tabindex="-1">
            <div class="modal-dialog modal-xl">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Yeni Arsa Analizi</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <div class="container-fluid">
                            <div class="row">
                                <div class="col-md-12">
                                    <!-- Progress bar -->
                                    <div class="progress mb-4">
                                        <div class="progress-bar" role="progressbar" style="width: 0%" id="formProgress"></div>
                                    </div>
                                    <div class="card">
                                        <div class="card-header bg-primary text-white">
                                            <h2 class="text-center">Arsa Yatırım Danışmanlığı</h2>
                                            <h4 class="text-center">Veri Giriş Formu</h4>
                                            <div class="float-end">
                                                <button type="button" class="btn btn-light btn-sm" id="saveAsFavorite">
                                                    <i class="bi bi-star"></i> Favorilere Ekle
                                                </button>
                                                <button type="button" class="btn btn-light btn-sm ms-2" id="clearForm">
                                                    <i class="bi bi-trash"></i> Formu Temizle
                                                </button>
                                            </div>
                                        </div>
                                        <div class="card-body border-top">
                                            <h5 class="mb-3"><i class="bi bi-star"></i> Favorilerim</h5>
                                            <div id="favoritesList" class="favorites-container">
                                                <!-- Favoriler buraya eklenecek -->
                                            </div>
                                        </div>
                                        <div class="card-body">
                                            <form id="arsaForm" action="/submit" method="post" class="needs-validation" novalidate>
                                                <!-- Parsel Bilgileri Bölümü -->
                                                <div class="card mb-4">
                                                    <div class="card-header bg-light">
                                                        <h5 class="mb-0">
                                                            <i class="bi bi-geo-alt"></i> Parsel Bilgileri
                                                        </h5>
                                                    </div>
                                                    <div class="card-body">
                                                        <div class="row">
                                                            <div class="col-md-4 mb-3">
                                                                <label for="il" class="form-label">İl</label>
                                                                <input type="text" class="form-control" id="il" name="il" required>
                                                                <div class="invalid-feedback">
                                                                    Lütfen il bilgisini giriniz.
                                                                </div>
                                                            </div>
                                                            <div class="col-md-4 mb-3">
                                                                <label for="ilce" class="form-label">İlçe</label>
                                                                <input type="text" class="form-control" id="ilce" name="ilce" required>
                                                                <div class="invalid-feedback">
                                                                    Lütfen ilçe bilgisini giriniz.
                                                                </div>
                                                            </div>
                                                            <div class="col-md-4 mb-3">
                                                                <label for="mahalle" class="form-label">Mahalle</label>
                                                                <input type="text" class="form-control" id="mahalle" name="mahalle" required>
                                                                <div class="invalid-feedback">
                                                                    Lütfen mahalle bilgisini giriniz.
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-md-4 mb-3">
                                                                <label for="ada" class="form-label">Ada No</label>
                                                                <input type="text" class="form-control" id="ada" name="ada" required>
                                                                <div class="invalid-feedback">
                                                                    Lütfen ada numarasını giriniz.
                                                                </div>
                                                            </div>
                                                            <div class="col-md-4 mb-3">
                                                                <label for="parsel" class="form-label">Parsel No</label>
                                                                <input type="text" class="form-control" id="parsel" name="parsel" required>
                                                                <div class="invalid-feedback">
                                                                    Lütfen parsel numarasını giriniz.
                                                                </div>
                                                            </div>
                                                            <div class="col-md-4 mb-3">
                                                                <label for="parselsorgu" class="form-label">&nbsp;</label>
                                                                <button type="button" id="parselsorgu" class="btn btn-info form-control">
                                                                    Parsel Bilgilerini Getir
                                                                </button>
                                                            </div>
                                                        </div>
                                                        <!-- Yeni alanlar -->
                                                        <div class="row">
                                                            <div class="col-md-4 mb-3">
                                                                <label for="koordinatlar" class="form-label">Koordinatlar</label>
                                                                <input type="text" class="form-control" id="koordinatlar" name="koordinatlar">
                                                            </div>
                                                            <div class="col-md-4 mb-3">
                                                                <label for="pafta" class="form-label">Pafta No</label>
                                                                <input type="text" class="form-control" id="pafta" name="pafta">
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- Arsa Bilgileri Bölümü -->
                                                <div class="card mb-4">
                                                    <div class="card-header bg-light">
                                                        <h5 class="mb-0">
                                                            <i class="bi bi-house"></i> Arsa Bilgileri
                                                        </h5>
                                                    </div>
                                                    <div class="card-body">
                                                        <div class="row">
                                                            <div class="col-md-6 mb-3">
                                                                <label for="metrekare" class="form-label">Metrekare</label>
                                                                <div class="input-group">
                                                                    <input type="number" class="form-control" id="metrekare" name="metrekare" min="1" step="0.01" required>
                                                                    <span class="input-group-text">m²</span>
                                                                    <div class="invalid-feedback">
                                                                        Lütfen geçerli bir metrekare değeri giriniz.
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6 mb-3">
                                                                <label for="imar_durumu" class="form-label">İmar Durumu</label>
                                                                <select class="form-select" id="imar_durumu" name="imar_durumu" required>
                                                                    <option value="" selected disabled>Seçiniz</option>
                                                                    <option value="konut">Konut</option>
                                                                    <option value="ticari">Ticari</option>
                                                                    <option value="karma">Karma</option>
                                                                    <option value="sanayi">Sanayi</option>
                                                                    <option value="diger">Diğer</option>
                                                                </select>
                                                                <div class="invalid-feedback">
                                                                    Lütfen imar durumunu seçiniz.
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="row mt-3" id="taksKaksRow">
                                                            <div class="col-md-6 mb-3">
                                                                <label for="taks" class="form-label">TAKS (Taban Alanı Katsayısı)</label>
                                                                <div class="input-group">
                                                                    <input type="number" class="form-control" id="taks" name="taks" min="0" max="1" step="0.01" value="0.3">
                                                                    <div class="invalid-feedback">
                                                                        TAKS değeri 0-1 arasında olmalıdır.
                                                                    </div>
                                                                </div>
                                                                <small class="form-text text-muted">Örnek: 0.3 (Arsa alanının %30'u kadar taban alanı)</small>
                                                            </div>
                                                            <div class="col-md-6 mb-3">
                                                                <label for="kaks" class="form-label">KAKS (Kat Alanı Katsayısı)</label>
                                                                <div class="input-group">
                                                                    <input type="number" class="form-control" id="kaks" name="kaks" min="0" step="0.01" value="1.5">
                                                                    <div class="invalid-feedback">
                                                                        Lütfen geçerli bir KAKS değeri giriniz.
                                                                    </div>
                                                                </div>
                                                                <small class="form-text text-muted">Örnek: 1.5 (Arsa alanının 1.5 katı kadar inşaat alanı)</small>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- SWOT Analizi -->
                                                <div class="card mb-4">
                                                    <div class="card-header bg-light">
                                                        <h5 class="mb-0">
                                                            <i class="bi bi-list-check"></i> SWOT Analizi
                                                        </h5>
                                                    </div>
                                                    <div class="card-body">
                                                        <!-- Güçlü Yönler -->
                                                        <div class="mb-4">
                                                            <h6>Güçlü Yönler (Strengths)</h6>
                                                            <div class="input-group mb-2">
                                                                <input type="text" class="form-control" id="yeniStrength" placeholder="Yeni güçlü yön ekleyin...">
                                                                <button class="btn btn-success" type="button" onclick="ekleSwot('strength')">
                                                                    <i class="bi bi-plus-lg"></i> Ekle
                                                                </button>
                                                            </div>
                                                            <div id="strengthList" class="list-group"></div>
                                                            <input type="hidden" name="strengths" id="strengthsInput">
                                                        </div>
                                                        <!-- Zayıf Yönler -->
                                                        <div class="mb-4">
                                                            <h6>Zayıf Yönler (Weaknesses)</h6>
                                                            <div class="input-group mb-2">
                                                                <input type="text" class="form-control" id="yeniWeakness" placeholder="Yeni zayıf yön ekleyin...">
                                                                <button class="btn btn-danger" type="button" onclick="ekleSwot('weakness')">
                                                                    <i class="bi bi-plus-lg"></i> Ekle
                                                                </button>
                                                            </div>
                                                            <div id="weaknessList" class="list-group"></div>
                                                            <input type="hidden" name="weaknesses" id="weaknessesInput">
                                                        </div>
                                                        <!-- Fırsatlar -->
                                                        <div class="mb-4">
                                                            <h6>Fırsatlar (Opportunities)</h6>
                                                            <div class="input-group mb-2">
                                                                <input type="text" class="form-control" id="yeniOpportunity" placeholder="Yeni fırsat ekleyin...">
                                                                <button class="btn btn-info" type="button" onclick="ekleSwot('opportunity')">
                                                                    <i class="bi bi-plus-lg"></i> Ekle
                                                                </button>
                                                            </div>
                                                            <div id="opportunityList" class="list-group"></div>
                                                            <input type="hidden" name="opportunities" id="opportunitiesInput">
                                                        </div>
                                                        <!-- Tehditler -->
                                                        <div>
                                                            <h6>Tehditler (Threats)</h6>
                                                            <div class="input-group mb-2">
                                                                <input type="text" class="form-control" id="yeniThreat" placeholder="Yeni tehdit ekleyin...">
                                                                <button class="btn btn-warning" type="button" onclick="ekleSwot('threat')">
                                                                    <i class="bi bi-plus-lg"></i> Ekle
                                                                </button>
                                                            </div>
                                                            <div id="threatList" class="list-group"></div>
                                                            <input type="hidden" name="threats" id="threatsInput">
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- Altyapı Bilgileri -->
                                                <div class="card mb-4">
                                                    <div class="card-header bg-light">
                                                        <h5 class="mb-0">
                                                            <i class="bi bi-wrench"></i> Altyapı Bilgileri
                                                        </h5>
                                                    </div>
                                                    <div class="card-body">
                                                        <div class="row">
                                                            <div class="col-12">
                                                                <label class="form-label">Altyapı Özellikleri</label>
                                                            </div>
                                                            <div class="col-md-3">
                                                                <div class="form-check">
                                                                    <input class="form-check-input" type="checkbox" id="yol" name="altyapi[]" value="yol">
                                                                    <label class="form-check-label" for="yol">Yol</label>
                                                                </div>
                                                            </div>
                                                            <div class="col-md-3">
                                                                <div class="form-check">
                                                                    <input class="form-check-input" type="checkbox" id="elektrik" name="altyapi[]" value="elektrik">
                                                                    <label class="form-check-label" for="elektrik">Elektrik</label>
                                                                </div>
                                                            </div>
                                                            <div class="col-md-3">
                                                                <div class="form-check">
                                                                    <input class="form-check-input" type="checkbox" id="su" name="altyapi[]" value="su">
                                                                    <label class="form-check-label" for="su">Su</label>
                                                                </div>
                                                            </div>
                                                            <div class="col-md-3">
                                                                <div class="form-check">
                                                                    <input class="form-check-input" type="checkbox" id="dogalgaz" name="altyapi[]" value="dogalgaz">
                                                                    <label class="form-check-label" for="dogalgaz">Doğalgaz</label>
                                                                </div>
                                                            </div>
                                                            <div class="col-md-3">
                                                                <div class="form-check">
                                                                    <input class="form-check-input" type="checkbox" id="kanalizasyon" name="altyapi[]" value="kanalizasyon">
                                                                    <label class="form-check-label" for="kanalizasyon">Kanalizasyon</label>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- Fiyat Bilgileri Bölümü -->
                                                <div class="card mb-4">
                                                    <div class="card-header bg-light">
                                                        <h5 class="mb-0">
                                                            <i class="bi bi-currency-exchange"></i> Fiyat Bilgileri
                                                        </h5>
                                                    </div>
                                                    <div class="card-body">
                                                        <div class="row">
                                                            <div class="col-md-6 mb-3">
                                                                <label for="fiyat" class="form-label">Arsa Fiyatı</label>
                                                                <div class="input-group">
                                                                    <input type="number" class="form-control" id="fiyat" name="fiyat" min="1" step="0.01" required>
                                                                    <span class="input-group-text">TL</span>
                                                                    <div class="invalid-feedback">
                                                                        Lütfen geçerli bir fiyat değeri giriniz.
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6 mb-3">
                                                                <label for="bolge_fiyat" class="form-label">Bölge m² Fiyatı</label>
                                                                <div class="input-group">
                                                                    <input type="number" class="form-control" id="bolge_fiyat" name="bolge_fiyat" min="1" step="0.01" required>
                                                                    <span class="input-group-text">TL/m²</span>
                                                                    <div class="invalid-feedback">
                                                                        Lütfen geçerli bir bölge fiyatı giriniz.
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="row">
                                                            <div class="col-md-12 mb-3">
                                                                <button type="button" id="bolgeFiyatGetir" class="btn btn-info">
                                                                    Bölge Fiyat Bilgilerini Getir
                                                                </button>
                                                                <div id="bolgeFiyatSonuc" class="mt-2"></div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="d-grid gap-2">
                                                    <button type="submit" class="btn btn-primary btn-lg">
                                                        <i class="bi bi-graph-up"></i> Analiz Et ve Sunum Oluştur
                                                    </button>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Bölge Dağılım Grafiği
        const locationChart = new Chart(
            document.getElementById('locationChart'),
            {
                type: 'pie',
                data: {
                    labels: JSON.parse(`{{ bolge_labels|tojson|safe }}`),
                    datasets: [{
                        data: JSON.parse(`{{ bolge_data|tojson|safe }}`),
                        backgroundColor: [
                            '#007bff', '#6610f2', '#6f42c1', '#e83e8c', '#fd7e14', '#20c997', '#ffc107', '#dc3545'
                        ]
                    }]
                }
            }
        );

        // Performans Grafiği
        const performanceChart = new Chart(
            document.getElementById('performanceChart'),
            {
                type: 'line',
                data: {
                    labels: JSON.parse(`{{ perf_labels|tojson|safe }}`),
                    datasets: [{
                        label: 'Yatırım Değeri (₺)',
                        data: JSON.parse(`{{ perf_data|tojson|safe }}`),
                        borderColor: '#007bff',
                        tension: 0.1
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            }
        );

        // SWOT listelerini ve input'ları saklayacak objeler
        const swotLists = {
            strength: [],
            weakness: [],
            opportunity: [],
            threat: []
        };

        // SWOT öğesi ekleme fonksiyonu
        function ekleSwot(tip) {
            const input = document.getElementById(`yeni${tip.charAt(0).toUpperCase() + tip.slice(1)}`);
            const list = document.getElementById(`${tip}List`);
            
            if (input.value.trim() === '') return;

            // Listeye öğe ekle
            if (!swotLists[tip]) {
                swotLists[tip] = [];
            }
            swotLists[tip].push(input.value.trim());
            
            // Liste öğesini oluştur
            const listItem = document.createElement('div');
            listItem.className = 'list-group-item d-flex justify-content-between align-items-center';
            listItem.innerHTML = `
                ${input.value}
                <button type="button" class="btn btn-sm btn-danger" onclick="silSwot('${tip}', ${swotLists[tip].length - 1})">
                    <i class="bi bi-trash"></i>
                </button>
            `;
            
            // Listeye ekle
            list.appendChild(listItem);
            
            // Hidden input'ları güncelle
            updateHiddenInputs();
            
            // Input'u temizle
            input.value = '';
        }

        // SWOT öğesi silme fonksiyonu
        function silSwot(tip, index) {
            const list = document.getElementById(`${tip}List`);
            
            // Listeden öğeyi kaldır
            swotLists[tip].splice(index, 1);
            
            // Liste öğelerini yeniden oluştur
            list.innerHTML = '';
            swotLists[tip].forEach((item, i) => {
                const listItem = document.createElement('div');
                listItem.className = 'list-group-item d-flex justify-content-between align-items-center';
                listItem.innerHTML = `
                    ${item}
                    <button type="button" class="btn btn-sm btn-danger" onclick="silSwot('${tip}', ${i})">
                        <i class="bi bi-trash"></i>
                    </button>
                `;
                list.appendChild(listItem);
            });
            
            // Hidden input'ları güncelle
            updateHiddenInputs();
        }

        // Hidden input'ları güncelle
        function updateHiddenInputs() {
            try {
                // Boş array'leri kontrol et ve oluştur
                if (!Array.isArray(swotLists.strength)) swotLists.strength = [];
                if (!Array.isArray(swotLists.weakness)) swotLists.weakness = [];
                if (!Array.isArray(swotLists.opportunity)) swotLists.opportunity = [];
                if (!Array.isArray(swotLists.threat)) swotLists.threat = [];

                // Hidden input'ları güncelle
                document.getElementById('strengthsInput').value = JSON.stringify(swotLists.strength);
                document.getElementById('weaknessesInput').value = JSON.stringify(swotLists.weakness);
                document.getElementById('opportunitiesInput').value = JSON.stringify(swotLists.opportunity);
                document.getElementById('threatsInput').value = JSON.stringify(swotLists.threat);
                
                console.log('Updated SWOT Values:', {
                    strengths: document.getElementById('strengthsInput').value,
                    weaknesses: document.getElementById('weaknessesInput').value,
                    opportunities: document.getElementById('opportunitiesInput').value,
                    threats: document.getElementById('threatsInput').value
                });
            } catch (error) {
                console.error('SWOT Update Error:', error);
            }
        }

        // Enter tuşu ile ekleme yapabilmek için
        document.querySelectorAll('#yeniStrength, #yeniWeakness, #yeniOpportunity, #yeniThreat').forEach(input => {
            input.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    const tip = this.id.replace('yeni', '').toLowerCase();
                    ekleSwot(tip);
                }
            });
        });

        // Form gönderilmeden önce SWOT verilerini kontrol et
        document.getElementById('arsaForm').addEventListener('submit', function(e) {
            try {
                // Form gönderilmeden önce tüm SWOT verilerini güncelle
                updateHiddenInputs();

                // Formdaki SWOT değerlerini kontrol et
                const swotValues = {
                    strengths: document.getElementById('strengthsInput').value,
                    weaknesses: document.getElementById('weaknessesInput').value,
                    opportunities: document.getElementById('opportunitiesInput').value,
                    threats: document.getElementById('threatsInput').value
                };
                console.log('Form Submit SWOT Values:', swotValues);
            } catch (error) {
                console.error('Form Submit Error:', error);
                e.preventDefault();
            }
        });

        // Form submit event listener
        document.getElementById('arsaForm').addEventListener('submit', function(e) {
            // Form gönderilmeden önce tüm SWOT verilerini güncelle
            updateHiddenInputs();
        });
    </script>
</body>
</html>